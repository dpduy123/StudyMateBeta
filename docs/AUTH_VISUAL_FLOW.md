# ğŸ¨ Authentication Visual Flow - SÆ¡ Ä‘á»“ trá»±c quan

## ğŸ”„ 1. ÄÄ‚NG KÃ - Registration Flow

```
ğŸ‘¤ User                    ğŸŒ Frontend                ğŸ” Supabase               ğŸ’¾ Database
  â”‚                           â”‚                         â”‚                         â”‚
  â”œâ”€ Nháº­p form â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                         â”‚                         â”‚
  â”‚  - Email: nva@uit.edu.vn  â”‚                         â”‚                         â”‚
  â”‚  - Password: 123456       â”‚                         â”‚                         â”‚
  â”‚  - Há» tÃªn: Nguyá»…n VÄƒn A   â”‚                         â”‚                         â”‚
  â”‚                           â”‚                         â”‚                         â”‚
  â”‚                           â”œâ”€ Validate .edu â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                         â”‚
  â”‚                           â”‚  email format           â”‚                         â”‚
  â”‚                           â”‚                         â”‚                         â”‚
  â”‚                           â”œâ”€ signUp() â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                         â”‚
  â”‚                           â”‚  {email, password}      â”‚                         â”‚
  â”‚                           â”‚                         â”‚                         â”‚
  â”‚                           â”‚                         â”œâ”€ Kiá»ƒm tra duplicate â”€â”€â–ºâ”‚
  â”‚                           â”‚                         â”‚                         â”‚
  â”‚                           â”‚                         â”‚                         â”œâ”€ Email má»›i?
  â”‚                           â”‚                         â”‚                         â”‚
  â”‚                           â”‚                         â”‚ â—„â”€â”€â”€â”€â”€ YES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                           â”‚                         â”‚                         â”‚
  â”‚                           â”‚                         â”œâ”€ Táº¡o user â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
  â”‚                           â”‚                         â”‚                         â”œâ”€ INSERT INTO auth.users
  â”‚                           â”‚                         â”‚                         â”‚
  â”‚                           â”‚                         â”œâ”€ Gá»­i email xÃ¡c thá»±c â”€â”€â–ºâ”‚ ğŸ“§
  â”‚                           â”‚                         â”‚                         â”‚
  â”‚                           â”‚ â—„â”€ {user: User} â”€â”€â”€â”€â”€â”€â”€â”€â”¤                         â”‚
  â”‚                           â”‚    {session: null}      â”‚                         â”‚
  â”‚                           â”‚                         â”‚                         â”‚
  â”‚ â—„â”€ "Kiá»ƒm tra email!" â”€â”€â”€â”€â”€â”¤                         â”‚                         â”‚
  â”‚                           â”‚                         â”‚                         â”‚

âŒ TrÆ°á»ng há»£p EMAIL TRÃ™NG:
  â”‚                           â”‚                         â”‚                         â”‚
  â”‚                           â”‚                         â”‚ â—„â”€â”€â”€â”€â”€ NO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ Email Ä‘Ã£ tá»“n táº¡i
  â”‚                           â”‚                         â”‚                         â”‚
  â”‚                           â”‚ â—„â”€ {user: null} â”€â”€â”€â”€â”€â”€â”€â”€â”¤                         â”‚
  â”‚                           â”‚    {session: null}      â”‚                         â”‚
  â”‚                           â”‚                         â”‚                         â”‚
  â”‚ â—„â”€ "Email Ä‘Ã£ Ä‘Äƒng kÃ½!" â”€â”€â”€â”¤                         â”‚                         â”‚
```

## ğŸ“§ 2. XÃC THá»°C EMAIL - Email Verification

```
ğŸ‘¤ User              ğŸ“§ Email Service         ğŸŒ Frontend           ğŸ” Supabase
  â”‚                      â”‚                       â”‚                     â”‚
  â”œâ”€ Má»Ÿ email â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚                     â”‚
  â”‚                      â”‚                       â”‚                     â”‚
  â”œâ”€ Click link â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚                     â”‚
  â”‚  "XÃ¡c thá»±c email"    â”‚                       â”‚                     â”‚
  â”‚                      â”‚                       â”‚                     â”‚
  â”‚                      â”œâ”€ Redirect â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚
  â”‚                      â”‚  /auth/callback       â”‚                     â”‚
  â”‚                      â”‚  ?code=abc123         â”‚                     â”‚
  â”‚                      â”‚                       â”‚                     â”‚
  â”‚                      â”‚                       â”œâ”€ exchangeCode â”€â”€â”€â”€â–ºâ”‚
  â”‚                      â”‚                       â”‚  ForSession()       â”‚
  â”‚                      â”‚                       â”‚                     â”‚
  â”‚                      â”‚                       â”‚ â—„â”€ {session} â”€â”€â”€â”€â”€â”€â”¤
  â”‚                      â”‚                       â”‚    {user}           â”‚
  â”‚                      â”‚                       â”‚                     â”‚
  â”‚                      â”‚                       â”œâ”€ Create profile â”€â”€â–ºâ”‚ ğŸ’¾ Database
  â”‚                      â”‚                       â”‚  API call           â”‚    â”‚
  â”‚                      â”‚                       â”‚                     â”‚    â”œâ”€ INSERT user profile
  â”‚                      â”‚                       â”‚                     â”‚    â”‚
  â”‚ â—„â”€ Redirect to â”€â”€â”€â”€â”€â”€â”¤ â—„â”€ Redirect â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                     â”‚    â”‚
  â”‚    /dashboard        â”‚    /dashboard         â”‚                     â”‚    â”‚
```

## ğŸ”‘ 3. ÄÄ‚NG NHáº¬P - Login Flow

```
ğŸ‘¤ User                ğŸŒ Frontend              ğŸ” Supabase            ğŸ’¾ Database
  â”‚                        â”‚                       â”‚                      â”‚
  â”œâ”€ Nháº­p form â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                       â”‚                      â”‚
  â”‚  Email: nva@uit.edu.vn â”‚                       â”‚                      â”‚
  â”‚  Password: 123456      â”‚                       â”‚                      â”‚
  â”‚                        â”‚                       â”‚                      â”‚
  â”‚                        â”œâ”€ signIn() â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                      â”‚
  â”‚                        â”‚  {email, password}    â”‚                      â”‚
  â”‚                        â”‚                       â”‚                      â”‚
  â”‚                        â”‚                       â”œâ”€ TÃ¬m user â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
  â”‚                        â”‚                       â”‚                      â”œâ”€ SELECT * FROM auth.users
  â”‚                        â”‚                       â”‚                      â”‚  WHERE email = ?
  â”‚                        â”‚                       â”‚                      â”‚
  â”‚                        â”‚                       â”‚ â—„â”€ User data â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                        â”‚                       â”‚                      â”‚
  â”‚                        â”‚                       â”œâ”€ Verify password â”€â”€â–ºâ”‚
  â”‚                        â”‚                       â”‚  bcrypt.compare()    â”‚
  â”‚                        â”‚                       â”‚                      â”‚
  â”‚                        â”‚                       â”‚ â—„â”€ âœ… Match â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                        â”‚                       â”‚                      â”‚
  â”‚                        â”‚                       â”œâ”€ Táº¡o JWT token â”€â”€â”€â”€â–ºâ”‚
  â”‚                        â”‚                       â”‚                      â”‚
  â”‚                        â”‚ â—„â”€ {session, user} â”€â”€â”¤                      â”‚
  â”‚                        â”‚                       â”‚                      â”‚
  â”‚ â—„â”€ Redirect /dashboard â”¤                       â”‚                      â”‚

âŒ SAI PASSWORD:
  â”‚                        â”‚                       â”‚ â—„â”€ âŒ No match â”€â”€â”€â”€â”€â”¤
  â”‚                        â”‚                       â”‚                      â”‚
  â”‚                        â”‚ â—„â”€ Error â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚
  â”‚                        â”‚  "Invalid credentials"â”‚                      â”‚
  â”‚                        â”‚                       â”‚                      â”‚
  â”‚ â—„â”€ "Sai máº­t kháº©u!" â”€â”€â”€â”€â”¤                       â”‚                      â”‚
```

## ğŸ›¡ï¸ 4. Báº¢O Vá»† TRANG - Auth Guard Flow

```
ğŸ‘¤ User                ğŸŒ Frontend               ğŸ” Auth Context        ğŸ’¾ LocalStorage
  â”‚                        â”‚                        â”‚                       â”‚
  â”œâ”€ Truy cáº­p /dashboard â–ºâ”‚                        â”‚                       â”‚
  â”‚                        â”‚                        â”‚                       â”‚
  â”‚                        â”œâ”€ AuthGuard check â”€â”€â”€â”€â–ºâ”‚                       â”‚
  â”‚                        â”‚                        â”‚                       â”‚
  â”‚                        â”‚                        â”œâ”€ Láº¥y token â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
  â”‚                        â”‚                        â”‚                       â”‚
  â”‚                        â”‚                        â”‚ â—„â”€ Token â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                        â”‚                        â”‚                       â”‚
  â”‚                        â”‚                        â”œâ”€ Kiá»ƒm tra háº¡n token â–ºâ”‚
  â”‚                        â”‚                        â”‚                       â”‚

âœ… TOKEN Há»¢P Lá»†:
  â”‚                        â”‚                        â”‚ â—„â”€ âœ… Valid â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                        â”‚                        â”‚                       â”‚
  â”‚                        â”‚ â—„â”€ Render content â”€â”€â”€â”€â”¤                       â”‚
  â”‚                        â”‚                        â”‚                       â”‚
  â”‚ â—„â”€ Hiá»ƒn thá»‹ dashboard â”€â”¤                        â”‚                       â”‚

âŒ TOKEN Háº¾T Háº N:
  â”‚                        â”‚                        â”‚ â—„â”€ âŒ Expired â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚                        â”‚                        â”‚                       â”‚
  â”‚                        â”‚ â—„â”€ Redirect login â”€â”€â”€â”€â”¤                       â”‚
  â”‚                        â”‚                        â”‚                       â”‚
  â”‚ â—„â”€ Chuyá»ƒn vá» /login â”€â”€â”€â”¤                        â”‚                       â”‚
```

## ğŸ”„ 5. QUáº¢N LÃ SESSION - Session Management

```
Time: 0h          1h           2h           3h
  â”‚               â”‚            â”‚            â”‚
  â”œâ”€ Login â”€â”€â”€â”€â”€â”€â–ºâ”œâ”€ Active â”€â”€â–ºâ”œâ”€ Warning â”€â–ºâ”œâ”€ Expired
  â”‚   Token táº¡o   â”‚  DÃ¹ng app  â”‚  "Sáº¯p háº¿t" â”‚  Auto logout
  â”‚               â”‚            â”‚   háº¡n"     â”‚
  â”‚               â”‚            â”‚            â”‚
  â”‚               â”‚            â”œâ”€ Refresh â”€â–ºâ”œâ”€ Extended
  â”‚               â”‚            â”‚  token     â”‚  +1h

ğŸ”„ AUTO REFRESH:
setInterval(() => {
  if (tokenSoonExpire()) {
    refreshToken();
  }
}, 5 * 60 * 1000); // Check every 5 minutes
```

## ğŸ¯ 6. STUDYMATE SPECIFIC FLOW

```
ğŸ“‹ ÄÄ‚NG KÃ STUDYMATE:

1. Form Validation:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Email: â–¡@â–¡.edu      â”‚ â—„â”€ Báº¯t buá»™c .edu
   â”‚ Password: â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢  â”‚ â—„â”€ Min 6 chars
   â”‚ Há» tÃªn: â–¡â–¡â–¡â–¡â–¡       â”‚ â—„â”€ KhÃ´ng empty
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
2. Duplicate Check:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ if (!data.user) {   â”‚
   â”‚   throw "ÄÃ£ Ä‘Äƒng kÃ½"â”‚ â—„â”€ Supabase Ä‘áº·c biá»‡t
   â”‚ }                   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
3. Success Flow:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Step 2: Verify Page â”‚
   â”‚ "Kiá»ƒm tra email!"   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ 7. ERROR HANDLING FLOW

```
ğŸš¨ Lá»–I THÆ¯á»œNG Gáº¶P:

Error Type              â”‚ Detection                â”‚ User Message
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Email duplicate         â”‚ !data.user              â”‚ "Email Ä‘Ã£ Ä‘Äƒng kÃ½!"
Password too short      â”‚ "Password should be"     â”‚ "Máº­t kháº©u Ã­t nháº¥t 6 kÃ½ tá»±!"
Invalid email format    â”‚ "Invalid email"          â”‚ "Email khÃ´ng há»£p lá»‡!"
Wrong credentials       â”‚ "Invalid credentials"    â”‚ "Email/password sai!"
Network error           â”‚ catch(NetworkError)      â”‚ "Lá»—i káº¿t ná»‘i!"

ğŸ”„ ERROR FLOW:
try {
  await authFunction();
} catch (error) {
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Parse error     â”‚
  â”‚ Show message    â”‚ â”€â”€â–º User sees friendly Vietnamese
  â”‚ Log for debug   â”‚ â”€â”€â–º Developer sees technical details
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
}
```

## ğŸ“± 8. RESPONSIVE AUTH

```
ğŸ“± MOBILE VIEW:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ StudyMate      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“§ Email        â”‚
â”‚ [____________]  â”‚
â”‚                 â”‚
â”‚ ğŸ”’ Password     â”‚
â”‚ [____________]  â”‚
â”‚                 â”‚
â”‚ [  ÄÄ‚NG NHáº¬P  ] â”‚
â”‚                 â”‚
â”‚ QuÃªn máº­t kháº©u?  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ’» DESKTOP VIEW:
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚           StudyMate             â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚ ğŸ“§ Email: [___________]   â”‚  â”‚
    â”‚  â”‚ ğŸ”’ Password: [________]   â”‚  â”‚
    â”‚  â”‚                           â”‚  â”‚
    â”‚  â”‚     [   ÄÄ‚NG NHáº¬P   ]     â”‚  â”‚
    â”‚  â”‚                           â”‚  â”‚
    â”‚  â”‚      QuÃªn máº­t kháº©u?       â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¨ 9. LOADING STATES

```
ğŸ”„ LOADING ANIMATIONS:

Initial Load:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â³ Äang táº£i... â”‚ â—„â”€ Check existing session
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Login Process:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [ğŸ”„ ÄÄƒng nháº­p...] â”‚ â—„â”€ Button disabled
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Registration:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ‰ï¸ Äang gá»­i...  â”‚ â—„â”€ Creating account
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Success:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… ThÃ nh cÃ´ng!  â”‚ â—„â”€ Brief success message
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š 10. DATA FLOW SUMMARY

```
ğŸ—‚ï¸ USER JOURNEY MAP:

Start â”€â”€â–º Register â”€â”€â–º Verify â”€â”€â–º Login â”€â”€â–º Dashboard â”€â”€â–º Logout
 â”‚           â”‚           â”‚         â”‚          â”‚            â”‚
 â”‚           â–¼           â”‚         â”‚          â–¼            â”‚
 â”‚        âœ‰ï¸Email       â”‚         â”‚       ğŸ›¡ï¸Guard        â”‚
 â”‚           â”‚           â”‚         â”‚          â”‚            â”‚
 â”‚           â–¼           â”‚         â”‚          â–¼            â”‚
 â”‚        ğŸ“§Check       â”‚         â–¼       ğŸ“„Content       â–¼
 â”‚           â”‚           â”‚      ğŸ”‘Token       â”‚         ğŸšªExit
 â”‚           â–¼           â”‚         â”‚          â”‚            â”‚
 â—„â”€â”€â”€â”€â”€â”€â”€ Click â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚          â”‚            â”‚
           â”‚                      â”‚          â”‚            â”‚
           â–¼                      â”‚          â”‚            â”‚
        âœ…Verified â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚          â”‚            â”‚
                                  â”‚          â”‚            â”‚
                               Session â”€â”€â”€â”€â”€â”€â”˜            â”‚
                                  â”‚                       â”‚
                               Timeout â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

*BÃ¢y giá» báº¡n Ä‘Ã£ cÃ³ sÆ¡ Ä‘á»“ trá»±c quan hoÃ n chá»‰nh vá» authentication! ğŸ‰*